---
- name: CRM Step 4 - Script 01
  win_shell: sqlcmd.exe -i "C:\BDLS\scripts\Step 4\Create_index_COMM_PRODUCT_CRM.sql" -v database="{{ crm_sid }}" schema="{{ crm_sid | lower }}"
  async: 1000000
  poll: 0
  register: Script_01

- name: CRM Step 4 - Script 02
  win_shell: sqlcmd.exe -i "C:\BDLS\scripts\Step 4\Create_index_CRMD_ORDERADM_H_CRM.sql" -v database="{{ crm_sid }}" schema="{{ crm_sid | lower }}"
  async: 1000000
  poll: 0
  register: Script_02

- name: CRM Step 4 - Script 03
  win_shell: sqlcmd.exe -i "C:\BDLS\scripts\Step 4\Create_index_CRMD_ORDERADM_I_CRM.sql" -v database="{{ crm_sid }}" schema="{{ crm_sid | lower }}"
  async: 1000000
  poll: 0
  register: Script_03

- name: CRM Step 4 - Script 04
  win_shell: sqlcmd.exe -i "C:\BDLS\scripts\Step 4\Create_index_GEOLOC_CRM.sql" -v database="{{ crm_sid }}" schema="{{ crm_sid | lower }}"
  async: 1000000
  poll: 0
  register: Script_04

- name: CRM Step 4 - Script 05
  win_shell: sqlcmd.exe -i "C:\BDLS\scripts\Step 4\Create_index_GEOOBJR_CRM.sql" -v database="{{ crm_sid }}" schema="{{ crm_sid | lower }}"
  async: 1000000
  poll: 0
  register: Script_05

- name: CRM Step 4 - Script 06
  win_shell: sqlcmd.exe -i "C:\BDLS\scripts\Step 4\Create_index_SRRELROLES_CRM.sql" -v database="{{ crm_sid }}" schema="{{ crm_sid | lower }}"
  async: 1000000
  poll: 0
  register: Script_06

- name: 'Script 01 - check on async task'
  async_status:
    jid: "{{ Script_01.ansible_job_id }}"
  register: job_result
  until: job_result.finished
  delay: 30
  retries: 50000

- name: 'Script 02 - check on async task'
  async_status:
    jid: "{{ Script_02.ansible_job_id }}"
  register: job_result
  until: job_result.finished
  delay: 30
  retries: 50000

- name: 'Script 03 - check on async task'
  async_status:
    jid: "{{ Script_03.ansible_job_id }}"
  register: job_result
  until: job_result.finished
  delay: 30
  retries: 50000

- name: 'Script 04 - check on async task'
  async_status:
    jid: "{{ Script_04.ansible_job_id }}"
  register: job_result
  until: job_result.finished
  delay: 30
  retries: 50000

- name: 'Script 05 - check on async task'
  async_status:
    jid: "{{ Script_05.ansible_job_id }}"
  register: job_result
  until: job_result.finished
  delay: 30
  retries: 50000

- name: 'Script 06 - check on async task'
  async_status:
    jid: "{{ Script_06.ansible_job_id }}"
  register: job_result
  until: job_result.finished
  delay: 30
  retries: 50000